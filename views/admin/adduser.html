<div id="main"><div class="container"><section id="adduser"><div class="hgroup"><h1>Add a user here !</h1><h2>Fill in the normal information of user.</h2><ul class="breadcrumb pull-right"><li><a href="/adminIndex">Home</a><span class="divider">/</span></li><li class="active">Add user</li></ul></div></section><div class="row"><div id="leftcol" class="span12"><div class="new_user"><form><div class="row"><div class="span4"></div><div class="span4"><!--h4 Publish a new user--><div class="input-group"><span class="input-group-addon">&nbsp&nbsp&nbsp&nbsp&nbspName</span><input type="text" ng-model="user.name" id="txt_name" placeholder="Name" class="form-control"/></div><br/><div class="input-group"><span class="input-group-addon">&nbsp&nbspAccount</span><input type="text" ng-model="user.account" id="txt_account" placeholder="Account" class="form-control"/></div><br/><div class="input-group"><span class="input-group-addon">&nbsp&nbsp&nbsp&nbsp&nbspPhone</span><input type="text" ng-model="user.phone" id="txt_cellphone" placeholder="Phone" class="form-control"/></div><br/><div class="input-group"><span class="input-group-addon">Password</span><input type="text" ng-model="user.password" id="txt_password" placeholder="Password" class="form-control"/></div></div><div class="span4"></div></div><br/><div class="row"><div class="span4"></div><div class="span1"><p style="padding: 6px 12px;font-size: 14px;font-weight: normal;line-height: 1;color: #555;text-align: center;background-color: #eee;border: 1px solid #ccc;border-radius: 4px;">Type</p></div><div class="span2"><select id="sel_type" name="usertype" ng-model="user.type" style="width:100%;"><option value="1">Ordinary users</option><option value="2">Dietitian</option><option value="3">Administrator</option></select></div><div class="span4"></div></div><div class="row"><div class="span4"></div><div class="span1"><p style="padding: 6px 12px;font-size: 14px;font-weight: normal;line-height: 1;color: #555;text-align: center;background-color: #eee;border: 1px solid #ccc;border-radius: 4px;">Sex</p></div><div class="span2"><select id="sel_sex" name="usersex" ng-model="user.sex" style="width:100%;"><option value="0">Male</option><option value="1">Female</option></select></div><div class="span4"></div></div><div class="row"><div class="span5"></div><div class="span3"><button id="btn_submit" onclick="submitData()" class="btn btn-primary btn-large pull-left"><span class="glyphicon glyphicon-ok">&nbsp;Submit</span></button></div><div class="span4"></div></div><br/><div class="row"><div class="span4"></div><div class="span4"><output id="result"></output></div><div class="span4"></div></div></form></div></div></div></div><!--p 欢迎来到添加用户系统--><!--form(id = "formtest")--><!--| 输入添加的用户信息--><!--br--><!--input(type = "text" id = "txt_name" name = "name" value = "姓名"--><!--onfocus = "if(value == defaultValue) value = ''" onblur = "if(!value) value = defaultValue")--><!--br--><!--input(type = "text" id = "txt_account" name = "account" value = "用户账户"--><!--onfocus = "if(value == defaultValue) value = ''" onblur = "if(!value) value = defaultValue")--><!--br--><!--input(type = "text" id = "txt_cellphone" name = "cellphone" value = "电话" onkeypress = "IsNum(event);"--><!--onfocus = "if(value == defaultValue) value = ''" onblur = "if(!value) value = defaultValue")--><!--br--><!--input(type = "text" id = "txt_password" name = "password" value = "密码"--><!--onfocus = "if(value == defaultValue) value = ''" onblur = "if(!value) value = defaultValue")--><!--br--><!--select(id = "sel_type" name = "usertype")--><!--	option(value = 1)| 普通用户--><!--	option(value = 2)| 营养师--><!--	option(value = 3)| 管理员--><!--select(id = "sel_sex" name = "usersex")--><!--	option(value = 0)| 男--><!--	option(value = 1)| 女--><!--br--><!--input(type = "button" value = "提交" onclick = "submitData();")--><!--br--><!--output(id="result")--><!--这个方法是用来判定输入的是否为数字--><!--我在想要是邮箱的话 正则表达式谁来写--><script>function IsNum(e)
{
	var k=window.event? e.keyCode : e.whitch;
	if((k>=48) && (k<=57) || k==8 || k==0)
	{

	}else
	{
		if(window.event)
		{
			window.event.returnValue = false;
		}else
			e.preventDefault();//为了火狐浏览器而设置
	}
}


function submitData()
{
	ListBox = document.getElementById("sel_type");
	var index = ListBox.selectedIndex;
	var sex_index = document.getElementById("sel_sex").selectedIndex;
	var obj = {
	name:document.getElementById("txt_name").value,
	tel:document.getElementById("txt_cellphone").value,
	account:document.getElementById("txt_account").value,
	password:document.getElementById("txt_password").value,
	type:ListBox.options[index].getAttribute("value"),
	sex:document.getElementById("sel_sex").options[sex_index].getAttribute("value")
	};
	var xhr = new XMLHttpRequest();
	xhr.open('post','/admin/add',true);
	xhr.onload = function(e)
	{
		//document.getElementById("result").innerHTML = this.response;
		alert(this.response);
		window.location.reload();
	}
	xhr.send(JSON.stringify(obj));
};</script></div>